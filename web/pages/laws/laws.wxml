<!--pages/laws/laws.wxml-->
<view class="page-container">
  <van-tabs active="{{ active }}">
    <van-tab title="小立法项">
      <van-cell-group>
        <van-cell wx:for="{{ rulesList }}" wx:key="index" title="{{ item.info }}" value="{{ item.score }}" />
      </van-cell-group>
    </van-tab>
    <van-tab title="每日评分">
      <van-index-bar>
        <view wx:for="{{ lawsList }}" wx:for-item="item" wx:key="index">
          <van-index-anchor index="{{ item.index }}" />
          <van-cell wx:for="{{ item.userList }}" wx:for-item="user" wx:key="user" title="{{ user }}" data-name="{{ user }}" is-link bind:click="showDialog" />
        </view>
      </van-index-bar>
    </van-tab>
    
    <van-tab title="项目修改">
      <van-swipe-cell wx:for="{{ rulesList }}" wx:key="index" right-width="{{ 60 }}" left-width="{{ 60 }}">
        <view slot="left" class="left" data-index="{{index}}" bindtap="showPopup">修改</view>
        <van-cell-group>
          <van-cell title="{{ item.info }}" value="{{ item.score }}" />
        </van-cell-group>
        <view slot="right" class="right" data-index="{{index}}" bindtap="deleteRules">删除</view>
      </van-swipe-cell>
    </van-tab>
  </van-tabs>
  <van-dialog
    id="van-dialog"
    show="{{ dialogVisible }}"
    title="组员评分"
    width="90%"
    show-confirm-button="{{ false }}"
    use-slot
  >
    <form bindreset="formReset" bindsubmit="saveData">
      <view class="input-container">
        <view class="input-label">
          <text>组员</text>
        </view>
        <view class="input-content">
          <input name="username" placeholder="请输入组员姓名" value="{{ formData.username }}" />
        </view>
      </view>
      <!-- <view class="input-container" bindtap="showPopup">
        <view class="input-label">
          <text>日期</text>
        </view>
        <view class="input-content">
          <input name="date" placeholder="请选择当前日期" value="{{ formData.currentDate }}" />
        </view>
      </view> -->
      <view class="input-container">
        <view class="input-label">
          <text>加/减分</text>
        </view>
        <view class="input-content">
          <radio-group name="radio">
            <label><radio value="add"/>加分</label>
            <label><radio value="deduct"/>扣分</label>
          </radio-group>
        </view>
      </view>
      <view>
        <view class="input-label">
          <text>规章条例</text>
        </view>
        <view class="input-content">
          <input name="laws" placeholder="请输入扣分条例" value="" />
        </view>
      </view>
      <view>
        <view class="input-label">
          <text>补充描述</text>
        </view>
        <view class="input-content">
          <textarea placeholder="填写补充说明" style="height: 50px;"></textarea>
        </view>
      </view>
      <view>
        <view class="input-label">
          <text>图片上传</text>
        </view>
        <view class="input-content">
          <van-uploader file-list="{{ fileList }}" bind:after-read="afterRead" />
        </view>
      </view>
      <view class="submit-container">
        <van-button bindtap="closeDialog" color="#c0c0c0" style="width: 50%;">取消</van-button>
        <van-button formType="submit" color="#1989fa"  style="width: 50%;">提交</van-button>
      </view>
    </form>
  </van-dialog>
  <van-popup
    show="{{ popupVisible }}"
    bind:close="closePopup"
    custom-style="height: 50%;"
    position="bottom"
  >
    <form bindsubmit="modifyRules">
      <view class="input-container">
          <view class="input-label">
            <text>规则分值</text>
          </view>
          <view class="input-content">
            <van-stepper value="{{ modifyInfo.score }}" bind:change="modifyScore" />
          </view>
        </view>
        <view>
          <view class="input-label">
            <text>规则信息</text>
          </view>
          <view class="input-content">
            <textarea placeholder="具体修改内容" value="{{ modifyInfo.info }}" bindinput="modifyInfo"></textarea>
          </view>
        </view>
        <van-button formType="submit" type="primary" block>提交</van-button>
      </form>
  </van-popup>
</view>
